{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Calculator,Plus,Trash2,X,Upload,Scissors,Package,Euro,ArrowLeft,Copy}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TreadOptimizationApp=()=>{var _projectData$stairs,_projectData$stairs$s;const[projectData,setProjectData]=useState(null);const[showUploadModal,setShowUploadModal]=useState(false);const[optimizationResults,setOptimizationResults]=useState(null);const[isCalculating,setIsCalculating]=useState(false);// Large planks configuration\nconst[largePlanks,setLargePlanks]=useState([{id:1,width:900,height:610,price:45.98,maxQuantity:null,name:'90x61cm'},{id:2,width:1210,height:610,price:60.13,maxQuantity:null,name:'121x61cm'},{id:3,width:1360,height:610,price:67.20,maxQuantity:null,name:'136x61cm'},{id:4,width:1810,height:610,price:96.69,maxQuantity:null,name:'181x61cm'}]);// Saw thickness\nconst[sawThickness,setSawThickness]=useState(10);// Extract treads from project data\nconst treads=(projectData===null||projectData===void 0?void 0:(_projectData$stairs=projectData.stairs)===null||_projectData$stairs===void 0?void 0:(_projectData$stairs$s=_projectData$stairs.steps)===null||_projectData$stairs$s===void 0?void 0:_projectData$stairs$s.map(step=>({id:step.stepNumber,width:Math.max(step.maxWidth,step.maxDepth),// Plus grande longueur\nheight:Math.min(step.maxWidth,step.maxDepth),// Plus grande largeur\nname:`Dessus de marche ${step.stepNumber}`,comment:step.comment})))||[];// Debug: log treads when projectData changes\nuseEffect(()=>{if(projectData){console.log('ProjectData mis à jour:',projectData);console.log('Dessus de marche extraits:',treads);}},[projectData,treads]);// Handle file upload\nconst handleFileUpload=event=>{const file=event.target.files[0];if(file){const reader=new FileReader();reader.onload=e=>{try{var _data$metadata;const data=JSON.parse(e.target.result);console.log('Fichier importé:',data);// Check if it's a valid stair measurement file\nconst isValidType=data.type==='stair-measurement'||((_data$metadata=data.metadata)===null||_data$metadata===void 0?void 0:_data$metadata.type)==='stair-measurement';const hasStairs=data.stairs&&data.stairs.steps&&Array.isArray(data.stairs.steps);if(isValidType&&hasStairs){console.log('Contremarches trouvées:',data.stairs.steps.length);setProjectData(data);setShowUploadModal(false);}else{console.error('Structure de fichier invalide:',data);alert('Fichier invalide. Veuillez utiliser un fichier exporté depuis l\\'étape 1.\\n\\nStructure attendue: fichier JSON avec type=\"stair-measurement\" et données des marches.');}}catch(error){console.error('Erreur de parsing JSON:',error);alert('Erreur lors de la lecture du fichier JSON: '+error.message);}};reader.readAsText(file);}};// Add new plank\nconst addNewPlank=()=>{const newId=Math.max(...largePlanks.map(p=>p.id),0)+1;setLargePlanks(prev=>[...prev,{id:newId,width:1000,height:610,price:0.00,maxQuantity:null,name:'100x61cm'}]);};// Delete plank\nconst deletePlank=id=>{setLargePlanks(prev=>prev.filter(p=>p.id!==id));};// Update plank\nconst updatePlank=(id,field,value)=>{setLargePlanks(prev=>prev.map(plank=>plank.id===id?{...plank,[field]:value}:plank));};// Generate plank name\nconst generatePlankName=(width,height)=>{return`${Math.round(width/10)}x${Math.round(height/10)}cm`;};// Optimization algorithm\nconst optimizeCutting=()=>{if(treads.length===0){alert('Aucun dessus de marche à optimiser !');return;}setIsCalculating(true);// Simulate calculation time\nsetTimeout(()=>{const solution=calculateOptimalCutting(treads,sawThickness);setOptimizationResults(solution);setIsCalculating(false);},1500);};// Calculate optimal cutting arrangement\nconst calculateOptimalCutting=(pieces,sawThickness)=>{const solution=[];let remainingPieces=pieces.map((piece,index)=>({...piece,instanceId:`piece-${piece.id}`,name:`${piece.id}`,originalIndex:index}));const plankUsage={};largePlanks.forEach(plank=>{plankUsage[plank.id]=0;});let totalCost=0;let totalPlanks=0;while(remainingPieces.length>0){let bestOption=null;let bestEfficiency=0;// Test each plank type\nfor(const plankType of largePlanks){if(plankType.maxQuantity&&plankUsage[plankType.id]>=plankType.maxQuantity){continue;}const arrangement=calculateBestArrangement(remainingPieces,plankType,sawThickness);const costPerArea=plankType.price/(plankType.width*plankType.height);const efficiency=arrangement.efficiency/costPerArea;if(efficiency>bestEfficiency&&arrangement.pieces.length>0){bestEfficiency=efficiency;bestOption={plankType,arrangement,costPerArea};}}if(bestOption){solution.push(bestOption);plankUsage[bestOption.plankType.id]++;totalCost+=bestOption.plankType.price;totalPlanks++;// Remove used pieces\nremainingPieces=remainingPieces.filter(piece=>!bestOption.arrangement.pieces.some(used=>used.instanceId===piece.instanceId));}else{// If no piece can be placed, try with available planks\nconst piece=remainingPieces[0];const availablePlanks=largePlanks.filter(plank=>!plank.maxQuantity||plankUsage[plank.id]<plank.maxQuantity);const suitablePlank=availablePlanks.find(plank=>{const fitNormal=piece.width<=plank.width&&piece.height<=plank.height;const fitRotated=piece.height<=plank.width&&piece.width<=plank.height;return fitNormal||fitRotated;});if(suitablePlank){const rotated=!(piece.width<=suitablePlank.width&&piece.height<=suitablePlank.height);solution.push({plankType:suitablePlank,arrangement:{pieces:[{...piece,rotated,x:0,y:0,displayWidth:rotated?piece.height:piece.width,displayHeight:rotated?piece.width:piece.height}],efficiency:piece.width*piece.height/(suitablePlank.width*suitablePlank.height)}});plankUsage[suitablePlank.id]++;totalCost+=suitablePlank.price;totalPlanks++;remainingPieces.shift();}else{break;}}}return{solution,totalCost,totalPlanks,remainingPieces,efficiency:solution.reduce((sum,item)=>sum+item.arrangement.efficiency,0)/solution.length};};// Calculate best arrangement for a plank\nconst calculateBestArrangement=(pieces,plankType,sawThickness)=>{const arrangements=[];// Try different piece combinations\nfor(let i=1;i<=Math.min(pieces.length,10);i++){const combinations=getCombinations(pieces,i);for(const combination of combinations){const arrangement=placePieces(combination,plankType,sawThickness);if(arrangement.pieces.length>0){const totalArea=arrangement.pieces.reduce((sum,piece)=>sum+piece.width*piece.height,0);arrangement.totalValue=totalArea;arrangement.efficiency=totalArea/(plankType.width*plankType.height);arrangements.push(arrangement);}}}return arrangements.reduce((best,current)=>current.totalValue>best.totalValue?current:best,{pieces:[],totalValue:0,efficiency:0});};// Get combinations of pieces\nconst getCombinations=(pieces,size)=>{if(size===1)return pieces.map(p=>[p]);if(size===pieces.length)return[pieces];const combinations=[];for(let i=0;i<=pieces.length-size;i++){const head=pieces[i];const tailCombinations=getCombinations(pieces.slice(i+1),size-1);for(const tail of tailCombinations){combinations.push([head,...tail]);}}return combinations;};// Place pieces on a plank\nconst placePieces=(pieces,plankType,sawThickness)=>{const placedPieces=[];for(const piece of pieces){const position=findBestPosition(piece,placedPieces,plankType,sawThickness);if(position){const rotated=position.rotated;placedPieces.push({...piece,x:position.x,y:position.y,rotated,displayWidth:rotated?piece.height:piece.width,displayHeight:rotated?piece.width:piece.height});}}return{pieces:placedPieces};};// Find best position for a piece\nconst findBestPosition=(piece,placedPieces,plankType,sawThickness)=>{const positions=[];// Try normal orientation\nif(piece.width<=plankType.width&&piece.height<=plankType.height){positions.push({x:0,y:0,rotated:false});}// Try rotated orientation\nif(piece.height<=plankType.width&&piece.width<=plankType.height){positions.push({x:0,y:0,rotated:true});}// Add positions near existing pieces\nfor(const existing of placedPieces){const rightPos={x:existing.x+existing.displayWidth+sawThickness,y:existing.y,rotated:false};const bottomPos={x:existing.x,y:existing.y+existing.displayHeight+sawThickness,rotated:false};positions.push(rightPos,bottomPos);}// Sort positions by x then y\npositions.sort((a,b)=>a.x-b.x||a.y-b.y);// Test each position\nfor(const pos of positions){if(canPlaceAt(piece,pos,placedPieces,plankType,sawThickness)){return pos;}}return null;};// Check if piece can be placed at position\nconst canPlaceAt=(piece,position,placedPieces,plankType,sawThickness)=>{const width=position.rotated?piece.height:piece.width;const height=position.rotated?piece.width:piece.height;// Check plank boundaries\nif(position.x+width>plankType.width||position.y+height>plankType.height){return false;}// Check collisions with existing pieces\nfor(const existing of placedPieces){if(!(position.x>=existing.x+existing.displayWidth+sawThickness||position.x+width+sawThickness<=existing.x||position.y>=existing.y+existing.displayHeight+sawThickness||position.y+height+sawThickness<=existing.y)){return false;}}return true;};// Generate plank summary\nconst generatePlankSummary=solution=>{const summary={};solution.solution.forEach(item=>{const plankName=generatePlankName(item.plankType.width,item.plankType.height);if(!summary[plankName]){summary[plankName]={count:0,price:item.plankType.price,dimensions:`${item.plankType.width}×${item.plankType.height}mm`};}summary[plankName].count++;});return Object.entries(summary).map(_ref=>{let[name,data]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-2 bg-white rounded border\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600 ml-2\",children:[\"(\",data.dimensions,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-blue-600\",children:[data.count,\" planche\",data.count>1?'s':'']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[data.count,\" \\xD7 \",data.price,\"\\u20AC = \",(data.count*data.price).toFixed(2),\"\\u20AC\"]})]})]},name);});};// Generate shopping list as text table\nconst generateShoppingListText=solution=>{const summary={};solution.solution.forEach(item=>{const plankName=generatePlankName(item.plankType.width,item.plankType.height);if(!summary[plankName]){summary[plankName]={count:0,price:item.plankType.price,dimensions:`${item.plankType.width}×${item.plankType.height}mm`};}summary[plankName].count++;});let tableText=\"Grande planche\\tQuantité\\tPU\\tPrix total\\n\";tableText+=\"-\\t-\\t-\\t-\\n\";let totalCost=0;Object.entries(summary).forEach(_ref2=>{let[name,data]=_ref2;const lineTotal=data.count*data.price;totalCost+=lineTotal;tableText+=`${name}\\t${data.count}\\t${data.price}€\\t${lineTotal.toFixed(2)}€\\n`;});tableText+=\"-\\t-\\t-\\t-\\n\";tableText+=`Total\\t\\t\\t${totalCost.toFixed(2)}€\\n`;return tableText;};// Copy shopping list to clipboard\nconst copyShoppingListToClipboard=()=>{if(!optimizationResults)return;const tableText=generateShoppingListText(optimizationResults);navigator.clipboard.writeText(tableText).then(()=>{// Show a temporary success message\nconst button=document.getElementById('copy-shopping-list-btn');if(button){const originalText=button.innerHTML;button.innerHTML='<Copy className=\"w-4 h-4\" /> Copié !';button.className='px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 flex items-center gap-1';setTimeout(()=>{button.innerHTML=originalText;button.className='px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1';},2000);}}).catch(err=>{console.error('Erreur lors de la copie:',err);alert('Erreur lors de la copie vers le presse-papiers');});};// Generate plank visualization\nconst generatePlankVisualization=(item,index)=>{const plankType=item.plankType;const arrangement=item.arrangement;// Calculate scale to maintain real proportions\nconst maxDisplayWidth=400;const maxDisplayHeight=200;const scaleX=maxDisplayWidth/plankType.width;const scaleY=maxDisplayHeight/plankType.height;const scale=Math.min(scaleX,scaleY);const displayWidth=plankType.width*scale;const displayHeight=plankType.height*scale;const colors=['bg-blue-300','bg-green-300','bg-red-300','bg-purple-300','bg-yellow-300','bg-pink-300','bg-indigo-300','bg-orange-300'];return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-300 p-4 bg-amber-50\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-semibold mb-2\",children:[generatePlankName(plankType.width,plankType.height),\" - \",plankType.price,\"\\u20AC\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative border-2 border-amber-800 bg-amber-100\",style:{width:displayWidth,height:displayHeight},children:arrangement.pieces.map((piece,pieceIndex)=>{const color=colors[piece.originalIndex%colors.length];return/*#__PURE__*/_jsx(\"div\",{className:`absolute border border-gray-700 ${color} flex items-center justify-center text-xs font-bold shadow-sm`,style:{width:piece.displayWidth*scale,height:piece.displayHeight*scale,left:piece.x*scale,top:piece.y*scale},children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center leading-tight\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:piece.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs\",children:[piece.width,\"\\xD7\",piece.height]}),piece.rotated&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs\",children:\"\\u21BB\"})]})},pieceIndex);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-sm text-gray-600 text-center\",children:[\"Pi\\xE8ces: \",arrangement.pieces.length,\" | Efficacit\\xE9: \",(arrangement.efficiency*100).toFixed(1),\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-xs text-gray-500 text-center\",children:[\"Dimensions: \",plankType.width,\"\\xD7\",plankType.height,\"mm | \\xC9chelle: 1:\",Math.round(1/scale)]})]},index);};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto p-6 bg-white min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4 mb-2\",children:/*#__PURE__*/_jsxs(\"a\",{href:\"/Sublimarches/optimiseur/contremarches/\",className:\"flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"w-4 h-4\"}),\"Retour \\xE0 l'\\xE9tape 2\"]})}),/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Scissors,{className:\"text-blue-600\"}),\"Optimisation des Dessus de Marche\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\xC9tape 3/3 : Optimisez la d\\xE9coupe des dessus de marche sur les grandes planches\"})]}),!projectData&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-6 rounded-lg mb-6 text-center\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-blue-800 mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Upload,{className:\"w-5 h-5\"}),\"Importer les mesures de l'\\xE9tape 1\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Uploadez le fichier JSON export\\xE9 depuis l'\\xE9tape 1 pour commencer l'optimisation\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowUploadModal(true),className:\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 mx-auto\",children:[/*#__PURE__*/_jsx(Upload,{className:\"w-5 h-5\"}),\"Choisir un fichier JSON\"]})]}),projectData&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-green-800 mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Package,{className:\"w-5 h-5\"}),\"Projet : \",projectData.project.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:treads.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Dessus de marche\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:(treads.reduce((sum,t)=>sum+t.width*t.height,0)/1000000).toFixed(2)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"m\\xB2 total\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600\",children:Math.max(...treads.map(t=>t.width))}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Longueur max (mm)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-orange-600\",children:Math.max(...treads.map(t=>t.height))}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Largeur max (mm)\"})]})]})]}),projectData&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-800 mb-3\",children:\"Param\\xE8tres g\\xE9n\\xE9raux\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Largeur de scie (mm)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:sawThickness,onChange:e=>setSawThickness(parseInt(e.target.value)||10),min:\"0\",max:\"50\",className:\"w-full p-2 border border-gray-300 rounded-md\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-blue-800 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Package,{className:\"w-5 h-5\"}),\"Grandes planches disponibles\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:addNewPlank,className:\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\"Ajouter\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:largePlanks.map(plank=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-white rounded border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-2 mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Largeur (mm)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:plank.width,onChange:e=>updatePlank(plank.id,'width',parseInt(e.target.value)||0),className:\"w-full p-1 text-sm border border-gray-300 rounded\",min:\"1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Hauteur (mm)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:plank.height,onChange:e=>updatePlank(plank.id,'height',parseInt(e.target.value)||0),className:\"w-full p-1 text-sm border border-gray-300 rounded\",min:\"1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Prix (\\u20AC)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:plank.price,onChange:e=>updatePlank(plank.id,'price',parseFloat(e.target.value)||0),className:\"w-full p-1 text-sm border border-gray-300 rounded\",min:\"0\",step:\"0.01\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Quantit\\xE9 max\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:plank.maxQuantity||'',onChange:e=>updatePlank(plank.id,'maxQuantity',e.target.value?parseInt(e.target.value):null),className:\"w-full p-1 text-sm border border-gray-300 rounded\",min:\"1\",placeholder:\"Illimit\\xE9\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[generatePlankName(plank.width,plank.height),\" - \",plank.price,\"\\u20AC\",plank.maxQuantity?` (max: ${plank.maxQuantity})`:' (illimité)']}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deletePlank(plank.id),className:\"p-1 text-red-600 hover:bg-red-100 rounded\",title:\"Supprimer cette planche\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})]},plank.id))})]})]}),projectData&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:optimizeCutting,disabled:isCalculating||treads.length===0,className:\"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 mx-auto text-lg font-semibold\",children:isCalculating?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"}),\"Calcul en cours...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Calculator,{className:\"w-5 h-5\"}),\"Calculer l'optimisation\"]})})}),optimizationResults&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-100 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-green-800 mb-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Euro,{className:\"w-5 h-5\"}),\"R\\xE9sultat de l'optimisation\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-green-600\",children:[optimizationResults.totalCost.toFixed(2),\"\\u20AC\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Co\\xFBt total\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:optimizationResults.totalPlanks}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Grandes planches\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600\",children:treads.length-optimizationResults.remainingPieces.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Dessus de marche plac\\xE9s\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-blue-800 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Package,{className:\"w-5 h-5\"}),\"R\\xE9capitulatif des planches \\xE0 commander\"]}),/*#__PURE__*/_jsxs(\"button\",{id:\"copy-shopping-list-btn\",onClick:copyShoppingListToClipboard,className:\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1\",title:\"Copier la liste d'achat au format tableau\",children:[/*#__PURE__*/_jsx(Copy,{className:\"w-4 h-4\"}),\"Copier liste\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[generatePlankSummary(optimizationResults),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-2 mt-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center font-bold text-lg\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total \\xE0 commander :\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600\",children:[optimizationResults.totalCost.toFixed(2),\"\\u20AC\"]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-800 mb-4\",children:\"Plan de d\\xE9coupe d\\xE9taill\\xE9\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:optimizationResults.solution.map((item,index)=>generatePlankVisualization(item,index))})]}),optimizationResults.remainingPieces.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-red-800 mb-2\",children:[\"Dessus de marche non plac\\xE9s (\",optimizationResults.remainingPieces.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-red-600\",children:optimizationResults.remainingPieces.map(p=>p.name).join(', ')})]})]}),showUploadModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg max-w-md w-full mx-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4 text-blue-800\",children:\"Importer les mesures\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Fichier JSON de l'\\xE9tape 1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".json\",onChange:handleFileUpload,className:\"w-full p-2 border border-gray-300 rounded-md\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowUploadModal(false),className:\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-md flex items-center gap-2\",children:[/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"}),\"Annuler\"]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-blue-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-blue-800 mb-2\",children:\"\\uD83D\\uDCCB Instructions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-blue-700 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"1.\"}),\" Importez le fichier JSON export\\xE9 depuis l'\\xE9tape 1\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"2.\"}),\" Ajustez les param\\xE8tres de scie et les grandes planches disponibles\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"3.\"}),\" Lancez l'optimisation pour obtenir le plan de d\\xE9coupe optimal\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"4.\"}),\" Visualisez les r\\xE9sultats et le co\\xFBt total\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-xs text-blue-600\",children:\"L'algorithme optimise pour le co\\xFBt total en tenant compte de l'efficacit\\xE9 de d\\xE9coupe et des prix des planches. Chaque dessus de marche utilise la plus grande longueur et largeur de la marche.\"})]})]});};export default TreadOptimizationApp;","map":{"version":3,"names":["React","useState","useEffect","Calculator","Plus","Trash2","X","Upload","Scissors","Package","Euro","ArrowLeft","Copy","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TreadOptimizationApp","_projectData$stairs","_projectData$stairs$s","projectData","setProjectData","showUploadModal","setShowUploadModal","optimizationResults","setOptimizationResults","isCalculating","setIsCalculating","largePlanks","setLargePlanks","id","width","height","price","maxQuantity","name","sawThickness","setSawThickness","treads","stairs","steps","map","step","stepNumber","Math","max","maxWidth","maxDepth","min","comment","console","log","handleFileUpload","event","file","target","files","reader","FileReader","onload","e","_data$metadata","data","JSON","parse","result","isValidType","type","metadata","hasStairs","Array","isArray","length","error","alert","message","readAsText","addNewPlank","newId","p","prev","deletePlank","filter","updatePlank","field","value","plank","generatePlankName","round","optimizeCutting","setTimeout","solution","calculateOptimalCutting","pieces","remainingPieces","piece","index","instanceId","originalIndex","plankUsage","forEach","totalCost","totalPlanks","bestOption","bestEfficiency","plankType","arrangement","calculateBestArrangement","costPerArea","efficiency","push","some","used","availablePlanks","suitablePlank","find","fitNormal","fitRotated","rotated","x","y","displayWidth","displayHeight","shift","reduce","sum","item","arrangements","i","combinations","getCombinations","combination","placePieces","totalArea","totalValue","best","current","size","head","tailCombinations","slice","tail","placedPieces","position","findBestPosition","positions","existing","rightPos","bottomPos","sort","a","b","pos","canPlaceAt","generatePlankSummary","summary","plankName","count","dimensions","Object","entries","_ref","className","children","toFixed","generateShoppingListText","tableText","_ref2","lineTotal","copyShoppingListToClipboard","navigator","clipboard","writeText","then","button","document","getElementById","originalText","innerHTML","catch","err","generatePlankVisualization","maxDisplayWidth","maxDisplayHeight","scaleX","scaleY","scale","colors","style","pieceIndex","color","left","top","href","onClick","project","t","onChange","parseInt","parseFloat","placeholder","title","disabled","join","accept"],"sources":["/Users/valentinbayard/Sublimarches/Sublimarches/optimiseur/dessus-marches/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Calculator, Plus, Trash2, X, Upload, Scissors, Package, Euro, ArrowLeft, Copy } from 'lucide-react';\n\nconst TreadOptimizationApp = () => {\n  const [projectData, setProjectData] = useState(null);\n  const [showUploadModal, setShowUploadModal] = useState(false);\n  const [optimizationResults, setOptimizationResults] = useState(null);\n  const [isCalculating, setIsCalculating] = useState(false);\n  \n  // Large planks configuration\n  const [largePlanks, setLargePlanks] = useState([\n    { id: 1, width: 900, height: 610, price: 45.98, maxQuantity: null, name: '90x61cm' },\n    { id: 2, width: 1210, height: 610, price: 60.13, maxQuantity: null, name: '121x61cm' },\n    { id: 3, width: 1360, height: 610, price: 67.20, maxQuantity: null, name: '136x61cm' },\n    { id: 4, width: 1810, height: 610, price: 96.69, maxQuantity: null, name: '181x61cm' }\n  ]);\n\n  // Saw thickness\n  const [sawThickness, setSawThickness] = useState(10);\n\n  // Extract treads from project data\n  const treads = projectData?.stairs?.steps?.map(step => ({\n    id: step.stepNumber,\n    width: Math.max(step.maxWidth, step.maxDepth), // Plus grande longueur\n    height: Math.min(step.maxWidth, step.maxDepth), // Plus grande largeur\n    name: `Dessus de marche ${step.stepNumber}`,\n    comment: step.comment\n  })) || [];\n  \n  // Debug: log treads when projectData changes\n  useEffect(() => {\n    if (projectData) {\n      console.log('ProjectData mis à jour:', projectData);\n      console.log('Dessus de marche extraits:', treads);\n    }\n  }, [projectData, treads]);\n\n  // Handle file upload\n  const handleFileUpload = (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        try {\n          const data = JSON.parse(e.target.result);\n          console.log('Fichier importé:', data);\n          \n          // Check if it's a valid stair measurement file\n          const isValidType = (data.type === 'stair-measurement' || data.metadata?.type === 'stair-measurement');\n          const hasStairs = data.stairs && data.stairs.steps && Array.isArray(data.stairs.steps);\n          \n          if (isValidType && hasStairs) {\n            console.log('Contremarches trouvées:', data.stairs.steps.length);\n            setProjectData(data);\n            setShowUploadModal(false);\n          } else {\n            console.error('Structure de fichier invalide:', data);\n            alert('Fichier invalide. Veuillez utiliser un fichier exporté depuis l\\'étape 1.\\n\\nStructure attendue: fichier JSON avec type=\"stair-measurement\" et données des marches.');\n          }\n        } catch (error) {\n          console.error('Erreur de parsing JSON:', error);\n          alert('Erreur lors de la lecture du fichier JSON: ' + error.message);\n        }\n      };\n      reader.readAsText(file);\n    }\n  };\n\n  // Add new plank\n  const addNewPlank = () => {\n    const newId = Math.max(...largePlanks.map(p => p.id), 0) + 1;\n    setLargePlanks(prev => [...prev, {\n      id: newId,\n      width: 1000,\n      height: 610,\n      price: 0.00,\n      maxQuantity: null,\n      name: '100x61cm'\n    }]);\n  };\n\n  // Delete plank\n  const deletePlank = (id) => {\n    setLargePlanks(prev => prev.filter(p => p.id !== id));\n  };\n\n  // Update plank\n  const updatePlank = (id, field, value) => {\n    setLargePlanks(prev => prev.map(plank => \n      plank.id === id ? { ...plank, [field]: value } : plank\n    ));\n  };\n\n  // Generate plank name\n  const generatePlankName = (width, height) => {\n    return `${Math.round(width/10)}x${Math.round(height/10)}cm`;\n  };\n\n  // Optimization algorithm\n  const optimizeCutting = () => {\n    if (treads.length === 0) {\n      alert('Aucun dessus de marche à optimiser !');\n      return;\n    }\n\n    setIsCalculating(true);\n\n    // Simulate calculation time\n    setTimeout(() => {\n      const solution = calculateOptimalCutting(treads, sawThickness);\n      setOptimizationResults(solution);\n      setIsCalculating(false);\n    }, 1500);\n  };\n\n  // Calculate optimal cutting arrangement\n  const calculateOptimalCutting = (pieces, sawThickness) => {\n    const solution = [];\n    let remainingPieces = pieces.map((piece, index) => ({\n      ...piece,\n      instanceId: `piece-${piece.id}`,\n      name: `${piece.id}`,\n      originalIndex: index\n    }));\n    \n    const plankUsage = {};\n    largePlanks.forEach(plank => {\n      plankUsage[plank.id] = 0;\n    });\n\n    let totalCost = 0;\n    let totalPlanks = 0;\n\n    while (remainingPieces.length > 0) {\n      let bestOption = null;\n      let bestEfficiency = 0;\n      \n      // Test each plank type\n      for (const plankType of largePlanks) {\n        if (plankType.maxQuantity && plankUsage[plankType.id] >= plankType.maxQuantity) {\n          continue;\n        }\n        \n        const arrangement = calculateBestArrangement(remainingPieces, plankType, sawThickness);\n        const costPerArea = plankType.price / (plankType.width * plankType.height);\n        const efficiency = arrangement.efficiency / costPerArea;\n        \n        if (efficiency > bestEfficiency && arrangement.pieces.length > 0) {\n          bestEfficiency = efficiency;\n          bestOption = {\n            plankType,\n            arrangement,\n            costPerArea\n          };\n        }\n      }\n      \n      if (bestOption) {\n        solution.push(bestOption);\n        plankUsage[bestOption.plankType.id]++;\n        totalCost += bestOption.plankType.price;\n        totalPlanks++;\n        \n        // Remove used pieces\n        remainingPieces = remainingPieces.filter(piece => \n          !bestOption.arrangement.pieces.some(used => used.instanceId === piece.instanceId)\n        );\n      } else {\n        // If no piece can be placed, try with available planks\n        const piece = remainingPieces[0];\n        const availablePlanks = largePlanks.filter(plank => \n          !plank.maxQuantity || plankUsage[plank.id] < plank.maxQuantity\n        );\n        \n        const suitablePlank = availablePlanks.find(plank => {\n          const fitNormal = piece.width <= plank.width && piece.height <= plank.height;\n          const fitRotated = piece.height <= plank.width && piece.width <= plank.height;\n          return fitNormal || fitRotated;\n        });\n        \n        if (suitablePlank) {\n          const rotated = !(piece.width <= suitablePlank.width && piece.height <= suitablePlank.height);\n          solution.push({\n            plankType: suitablePlank,\n            arrangement: { \n              pieces: [{\n                ...piece,\n                rotated,\n                x: 0,\n                y: 0,\n                displayWidth: rotated ? piece.height : piece.width,\n                displayHeight: rotated ? piece.width : piece.height\n              }],\n              efficiency: (piece.width * piece.height) / (suitablePlank.width * suitablePlank.height)\n            }\n          });\n          plankUsage[suitablePlank.id]++;\n          totalCost += suitablePlank.price;\n          totalPlanks++;\n          remainingPieces.shift();\n        } else {\n          break;\n        }\n      }\n    }\n\n    return {\n      solution,\n      totalCost,\n      totalPlanks,\n      remainingPieces,\n      efficiency: solution.reduce((sum, item) => sum + item.arrangement.efficiency, 0) / solution.length\n    };\n  };\n\n  // Calculate best arrangement for a plank\n  const calculateBestArrangement = (pieces, plankType, sawThickness) => {\n    const arrangements = [];\n    \n    // Try different piece combinations\n    for (let i = 1; i <= Math.min(pieces.length, 10); i++) {\n      const combinations = getCombinations(pieces, i);\n      \n      for (const combination of combinations) {\n        const arrangement = placePieces(combination, plankType, sawThickness);\n        if (arrangement.pieces.length > 0) {\n          const totalArea = arrangement.pieces.reduce((sum, piece) => \n            sum + (piece.width * piece.height), 0\n          );\n          arrangement.totalValue = totalArea;\n          arrangement.efficiency = totalArea / (plankType.width * plankType.height);\n          arrangements.push(arrangement);\n        }\n      }\n    }\n    \n    return arrangements.reduce((best, current) => \n      current.totalValue > best.totalValue ? current : best\n    , { pieces: [], totalValue: 0, efficiency: 0 });\n  };\n\n  // Get combinations of pieces\n  const getCombinations = (pieces, size) => {\n    if (size === 1) return pieces.map(p => [p]);\n    if (size === pieces.length) return [pieces];\n    \n    const combinations = [];\n    for (let i = 0; i <= pieces.length - size; i++) {\n      const head = pieces[i];\n      const tailCombinations = getCombinations(pieces.slice(i + 1), size - 1);\n      for (const tail of tailCombinations) {\n        combinations.push([head, ...tail]);\n      }\n    }\n    return combinations;\n  };\n\n  // Place pieces on a plank\n  const placePieces = (pieces, plankType, sawThickness) => {\n    const placedPieces = [];\n    \n    for (const piece of pieces) {\n      const position = findBestPosition(piece, placedPieces, plankType, sawThickness);\n      if (position) {\n        const rotated = position.rotated;\n        placedPieces.push({\n          ...piece,\n          x: position.x,\n          y: position.y,\n          rotated,\n          displayWidth: rotated ? piece.height : piece.width,\n          displayHeight: rotated ? piece.width : piece.height\n        });\n      }\n    }\n    \n    return { pieces: placedPieces };\n  };\n\n  // Find best position for a piece\n  const findBestPosition = (piece, placedPieces, plankType, sawThickness) => {\n    const positions = [];\n    \n    // Try normal orientation\n    if (piece.width <= plankType.width && piece.height <= plankType.height) {\n      positions.push({ x: 0, y: 0, rotated: false });\n    }\n    \n    // Try rotated orientation\n    if (piece.height <= plankType.width && piece.width <= plankType.height) {\n      positions.push({ x: 0, y: 0, rotated: true });\n    }\n    \n    // Add positions near existing pieces\n    for (const existing of placedPieces) {\n      const rightPos = { x: existing.x + existing.displayWidth + sawThickness, y: existing.y, rotated: false };\n      const bottomPos = { x: existing.x, y: existing.y + existing.displayHeight + sawThickness, rotated: false };\n      positions.push(rightPos, bottomPos);\n    }\n    \n    // Sort positions by x then y\n    positions.sort((a, b) => a.x - b.x || a.y - b.y);\n    \n    // Test each position\n    for (const pos of positions) {\n      if (canPlaceAt(piece, pos, placedPieces, plankType, sawThickness)) {\n        return pos;\n      }\n    }\n    \n    return null;\n  };\n\n  // Check if piece can be placed at position\n  const canPlaceAt = (piece, position, placedPieces, plankType, sawThickness) => {\n    const width = position.rotated ? piece.height : piece.width;\n    const height = position.rotated ? piece.width : piece.height;\n    \n    // Check plank boundaries\n    if (position.x + width > plankType.width || position.y + height > plankType.height) {\n      return false;\n    }\n    \n    // Check collisions with existing pieces\n    for (const existing of placedPieces) {\n      if (!(position.x >= existing.x + existing.displayWidth + sawThickness ||\n            position.x + width + sawThickness <= existing.x ||\n            position.y >= existing.y + existing.displayHeight + sawThickness ||\n            position.y + height + sawThickness <= existing.y)) {\n        return false;\n      }\n    }\n    \n    return true;\n  };\n\n  // Generate plank summary\n  const generatePlankSummary = (solution) => {\n    const summary = {};\n    solution.solution.forEach(item => {\n      const plankName = generatePlankName(item.plankType.width, item.plankType.height);\n      if (!summary[plankName]) {\n        summary[plankName] = { \n          count: 0, \n          price: item.plankType.price, \n          dimensions: `${item.plankType.width}×${item.plankType.height}mm` \n        };\n      }\n      summary[plankName].count++;\n    });\n\n    return Object.entries(summary).map(([name, data]) => (\n      <div key={name} className=\"flex justify-between items-center p-2 bg-white rounded border\">\n        <div>\n          <span className=\"font-medium\">{name}</span>\n          <span className=\"text-sm text-gray-600 ml-2\">({data.dimensions})</span>\n        </div>\n        <div className=\"text-right\">\n          <div className=\"font-semibold text-blue-600\">\n            {data.count} planche{data.count > 1 ? 's' : ''}\n          </div>\n          <div className=\"text-sm text-gray-600\">\n            {data.count} × {data.price}€ = {(data.count * data.price).toFixed(2)}€\n          </div>\n        </div>\n      </div>\n    ));\n  };\n\n  // Generate shopping list as text table\n  const generateShoppingListText = (solution) => {\n    const summary = {};\n    solution.solution.forEach(item => {\n      const plankName = generatePlankName(item.plankType.width, item.plankType.height);\n      if (!summary[plankName]) {\n        summary[plankName] = { \n          count: 0, \n          price: item.plankType.price, \n          dimensions: `${item.plankType.width}×${item.plankType.height}mm` \n        };\n      }\n      summary[plankName].count++;\n    });\n\n    let tableText = \"Grande planche\\tQuantité\\tPU\\tPrix total\\n\";\n    tableText += \"-\\t-\\t-\\t-\\n\";\n    \n    let totalCost = 0;\n    Object.entries(summary).forEach(([name, data]) => {\n      const lineTotal = data.count * data.price;\n      totalCost += lineTotal;\n      tableText += `${name}\\t${data.count}\\t${data.price}€\\t${lineTotal.toFixed(2)}€\\n`;\n    });\n    \n    tableText += \"-\\t-\\t-\\t-\\n\";\n    tableText += `Total\\t\\t\\t${totalCost.toFixed(2)}€\\n`;\n    \n    return tableText;\n  };\n\n  // Copy shopping list to clipboard\n  const copyShoppingListToClipboard = () => {\n    if (!optimizationResults) return;\n    \n    const tableText = generateShoppingListText(optimizationResults);\n    \n    navigator.clipboard.writeText(tableText).then(() => {\n      // Show a temporary success message\n      const button = document.getElementById('copy-shopping-list-btn');\n      if (button) {\n        const originalText = button.innerHTML;\n        button.innerHTML = '<Copy className=\"w-4 h-4\" /> Copié !';\n        button.className = 'px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 flex items-center gap-1';\n        setTimeout(() => {\n          button.innerHTML = originalText;\n          button.className = 'px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1';\n        }, 2000);\n      }\n    }).catch(err => {\n      console.error('Erreur lors de la copie:', err);\n      alert('Erreur lors de la copie vers le presse-papiers');\n    });\n  };\n\n  // Generate plank visualization\n  const generatePlankVisualization = (item, index) => {\n    const plankType = item.plankType;\n    const arrangement = item.arrangement;\n    \n    // Calculate scale to maintain real proportions\n    const maxDisplayWidth = 400;\n    const maxDisplayHeight = 200;\n    const scaleX = maxDisplayWidth / plankType.width;\n    const scaleY = maxDisplayHeight / plankType.height;\n    const scale = Math.min(scaleX, scaleY);\n    \n    const displayWidth = plankType.width * scale;\n    const displayHeight = plankType.height * scale;\n    \n    const colors = ['bg-blue-300', 'bg-green-300', 'bg-red-300', 'bg-purple-300', 'bg-yellow-300', 'bg-pink-300', 'bg-indigo-300', 'bg-orange-300'];\n    \n    return (\n      <div key={index} className=\"border border-gray-300 p-4 bg-amber-50\">\n        <h4 className=\"font-semibold mb-2\">{generatePlankName(plankType.width, plankType.height)} - {plankType.price}€</h4>\n        <div className=\"flex justify-center\">\n          <div \n            className=\"relative border-2 border-amber-800 bg-amber-100\" \n            style={{ width: displayWidth, height: displayHeight }}\n          >\n            {arrangement.pieces.map((piece, pieceIndex) => {\n              const color = colors[piece.originalIndex % colors.length];\n              return (\n                <div \n                  key={pieceIndex}\n                  className={`absolute border border-gray-700 ${color} flex items-center justify-center text-xs font-bold shadow-sm`}\n                  style={{\n                    width: piece.displayWidth * scale,\n                    height: piece.displayHeight * scale,\n                    left: piece.x * scale,\n                    top: piece.y * scale\n                  }}\n                >\n                  <div className=\"text-center leading-tight\">\n                    <div className=\"font-bold\">{piece.name}</div>\n                    <div className=\"text-xs\">{piece.width}×{piece.height}</div>\n                    {piece.rotated && <div className=\"text-xs\">↻</div>}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n        <div className=\"mt-2 text-sm text-gray-600 text-center\">\n          Pièces: {arrangement.pieces.length} | \n          Efficacité: {(arrangement.efficiency * 100).toFixed(1)}%\n        </div>\n        <div className=\"mt-1 text-xs text-gray-500 text-center\">\n          Dimensions: {plankType.width}×{plankType.height}mm | Échelle: 1:{Math.round(1/scale)}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6 bg-white min-h-screen\">\n      <div className=\"mb-6\">\n        <div className=\"flex items-center gap-4 mb-2\">\n          <a \n            href=\"/Sublimarches/optimiseur/contremarches/\" \n            className=\"flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm\"\n          >\n            <ArrowLeft className=\"w-4 h-4\" />\n            Retour à l'étape 2\n          </a>\n        </div>\n        <h1 className=\"text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2\">\n          <Scissors className=\"text-blue-600\" />\n          Optimisation des Dessus de Marche\n        </h1>\n        <p className=\"text-gray-600\">\n          Étape 3/3 : Optimisez la découpe des dessus de marche sur les grandes planches\n        </p>\n      </div>\n\n      {/* File Upload Section */}\n      {!projectData && (\n        <div className=\"bg-blue-50 p-6 rounded-lg mb-6 text-center\">\n          <h3 className=\"font-semibold text-blue-800 mb-4 flex items-center gap-2\">\n            <Upload className=\"w-5 h-5\" />\n            Importer les mesures de l'étape 1\n          </h3>\n          <p className=\"text-gray-600 mb-4\">\n            Uploadez le fichier JSON exporté depuis l'étape 1 pour commencer l'optimisation\n          </p>\n          <button\n            onClick={() => setShowUploadModal(true)}\n            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 mx-auto\"\n          >\n            <Upload className=\"w-5 h-5\" />\n            Choisir un fichier JSON\n          </button>\n        </div>\n      )}\n\n      {/* Project Info */}\n      {projectData && (\n        <div className=\"bg-green-50 p-4 rounded-lg mb-6\">\n          <h3 className=\"font-semibold text-green-800 mb-3 flex items-center gap-2\">\n            <Package className=\"w-5 h-5\" />\n            Projet : {projectData.project.name}\n          </h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\n            <div>\n              <div className=\"text-2xl font-bold text-green-600\">{treads.length}</div>\n              <div className=\"text-sm text-gray-600\">Dessus de marche</div>\n            </div>\n            <div>\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {(treads.reduce((sum, t) => sum + (t.width * t.height), 0) / 1000000).toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-600\">m² total</div>\n            </div>\n            <div>\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {Math.max(...treads.map(t => t.width))}\n              </div>\n              <div className=\"text-sm text-gray-600\">Longueur max (mm)</div>\n            </div>\n            <div>\n              <div className=\"text-2xl font-bold text-orange-600\">\n                {Math.max(...treads.map(t => t.height))}\n              </div>\n              <div className=\"text-sm text-gray-600\">Largeur max (mm)</div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Configuration */}\n      {projectData && (\n        <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\n          {/* General Parameters */}\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <h3 className=\"font-semibold text-gray-800 mb-3\">Paramètres généraux</h3>\n            <div className=\"space-y-3\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Largeur de scie (mm)\n                </label>\n                <input\n                  type=\"number\"\n                  value={sawThickness}\n                  onChange={(e) => setSawThickness(parseInt(e.target.value) || 10)}\n                  min=\"0\"\n                  max=\"50\"\n                  className=\"w-full p-2 border border-gray-300 rounded-md\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Large Planks */}\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex justify-between items-center mb-3\">\n              <h3 className=\"font-semibold text-blue-800 flex items-center gap-2\">\n                <Package className=\"w-5 h-5\" />\n                Grandes planches disponibles\n              </h3>\n              <button\n                onClick={addNewPlank}\n                className=\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1\"\n              >\n                <Plus className=\"w-4 h-4\" />\n                Ajouter\n              </button>\n            </div>\n            \n            <div className=\"space-y-2\">\n              {largePlanks.map((plank) => (\n                <div key={plank.id} className=\"p-3 bg-white rounded border\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 mb-2\">\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 mb-1\">Largeur (mm)</label>\n                      <input\n                        type=\"number\"\n                        value={plank.width}\n                        onChange={(e) => updatePlank(plank.id, 'width', parseInt(e.target.value) || 0)}\n                        className=\"w-full p-1 text-sm border border-gray-300 rounded\"\n                        min=\"1\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 mb-1\">Hauteur (mm)</label>\n                      <input\n                        type=\"number\"\n                        value={plank.height}\n                        onChange={(e) => updatePlank(plank.id, 'height', parseInt(e.target.value) || 0)}\n                        className=\"w-full p-1 text-sm border border-gray-300 rounded\"\n                        min=\"1\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 mb-1\">Prix (€)</label>\n                      <input\n                        type=\"number\"\n                        value={plank.price}\n                        onChange={(e) => updatePlank(plank.id, 'price', parseFloat(e.target.value) || 0)}\n                        className=\"w-full p-1 text-sm border border-gray-300 rounded\"\n                        min=\"0\"\n                        step=\"0.01\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-700 mb-1\">Quantité max</label>\n                      <input\n                        type=\"number\"\n                        value={plank.maxQuantity || ''}\n                        onChange={(e) => updatePlank(plank.id, 'maxQuantity', e.target.value ? parseInt(e.target.value) : null)}\n                        className=\"w-full p-1 text-sm border border-gray-300 rounded\"\n                        min=\"1\"\n                        placeholder=\"Illimité\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"text-sm text-gray-600\">\n                      {generatePlankName(plank.width, plank.height)} - {plank.price}€\n                      {plank.maxQuantity ? ` (max: ${plank.maxQuantity})` : ' (illimité)'}\n                    </div>\n                    <button\n                      onClick={() => deletePlank(plank.id)}\n                      className=\"p-1 text-red-600 hover:bg-red-100 rounded\"\n                      title=\"Supprimer cette planche\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Calculate Button */}\n      {projectData && (\n        <div className=\"text-center mb-6\">\n          <button\n            onClick={optimizeCutting}\n            disabled={isCalculating || treads.length === 0}\n            className=\"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 mx-auto text-lg font-semibold\"\n          >\n            {isCalculating ? (\n              <>\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                Calcul en cours...\n              </>\n            ) : (\n              <>\n                <Calculator className=\"w-5 h-5\" />\n                Calculer l'optimisation\n              </>\n            )}\n          </button>\n        </div>\n      )}\n\n      {/* Results */}\n      {optimizationResults && (\n        <div className=\"space-y-6\">\n          <div className=\"bg-green-100 p-4 rounded-lg\">\n            <h3 className=\"font-semibold text-green-800 mb-2 flex items-center gap-2\">\n              <Euro className=\"w-5 h-5\" />\n              Résultat de l'optimisation\n            </h3>\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">\n                  {optimizationResults.totalCost.toFixed(2)}€\n                </div>\n                <div className=\"text-sm text-gray-600\">Coût total</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">\n                  {optimizationResults.totalPlanks}\n                </div>\n                <div className=\"text-sm text-gray-600\">Grandes planches</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-purple-600\">\n                  {treads.length - optimizationResults.remainingPieces.length}\n                </div>\n                <div className=\"text-sm text-gray-600\">Dessus de marche placés</div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex justify-between items-center mb-3\">\n              <h3 className=\"font-semibold text-blue-800 flex items-center gap-2\">\n                <Package className=\"w-5 h-5\" />\n                Récapitulatif des planches à commander\n              </h3>\n              <button\n                id=\"copy-shopping-list-btn\"\n                onClick={copyShoppingListToClipboard}\n                className=\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center gap-1\"\n                title=\"Copier la liste d'achat au format tableau\"\n              >\n                <Copy className=\"w-4 h-4\" />\n                Copier liste\n              </button>\n            </div>\n            <div className=\"space-y-2\">\n              {generatePlankSummary(optimizationResults)}\n              <div className=\"border-t pt-2 mt-3\">\n                <div className=\"flex justify-between items-center font-bold text-lg\">\n                  <span>Total à commander :</span>\n                  <span className=\"text-blue-600\">{optimizationResults.totalCost.toFixed(2)}€</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h3 className=\"font-semibold text-gray-800 mb-4\">Plan de découpe détaillé</h3>\n            <div className=\"space-y-4\">\n              {optimizationResults.solution.map((item, index) => generatePlankVisualization(item, index))}\n            </div>\n          </div>\n\n          {optimizationResults.remainingPieces.length > 0 && (\n            <div className=\"bg-red-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-red-800 mb-2\">\n                Dessus de marche non placés ({optimizationResults.remainingPieces.length})\n              </h3>\n              <div className=\"text-sm text-red-600\">\n                {optimizationResults.remainingPieces.map(p => p.name).join(', ')}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Upload Modal */}\n      {showUploadModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white p-6 rounded-lg max-w-md w-full mx-4\">\n            <h3 className=\"text-lg font-semibold mb-4 text-blue-800\">\n              Importer les mesures\n            </h3>\n            \n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Fichier JSON de l'étape 1\n              </label>\n              <input\n                type=\"file\"\n                accept=\".json\"\n                onChange={handleFileUpload}\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\n              />\n            </div>\n            \n            <div className=\"flex justify-end gap-2\">\n              <button\n                onClick={() => setShowUploadModal(false)}\n                className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-md flex items-center gap-2\"\n              >\n                <X className=\"w-4 h-4\" />\n                Annuler\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Instructions */}\n      <div className=\"mt-8 bg-blue-50 p-4 rounded-lg\">\n        <h4 className=\"font-semibold text-blue-800 mb-2\">📋 Instructions</h4>\n        <div className=\"text-sm text-blue-700 space-y-1\">\n          <p><strong>1.</strong> Importez le fichier JSON exporté depuis l'étape 1</p>\n          <p><strong>2.</strong> Ajustez les paramètres de scie et les grandes planches disponibles</p>\n          <p><strong>3.</strong> Lancez l'optimisation pour obtenir le plan de découpe optimal</p>\n          <p><strong>4.</strong> Visualisez les résultats et le coût total</p>\n        </div>\n        <div className=\"mt-3 text-xs text-blue-600\">\n          L'algorithme optimise pour le coût total en tenant compte de l'efficacité de découpe et des prix des planches. \n          Chaque dessus de marche utilise la plus grande longueur et largeur de la marche.\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TreadOptimizationApp;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}